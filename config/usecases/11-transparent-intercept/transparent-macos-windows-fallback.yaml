version: 1
state_dir: "${QPX_STATE_DIR:-~/.local/share/qpx}"
listeners:
  - name: transparent-nonlinux
    mode: transparent
    listen: "0.0.0.0:15002"
    default_action: { type: block }
    rules:
      - name: inspect-work-sni
        match:
          src_ip: ["127.0.0.1/32", "::1/128", "10.0.0.0/8", "172.16.0.0/12", "192.168.0.0/16"]
          sni: ["*.corp.example.com"]
        action: { type: tunnel }
      - name: block-streaming
        match:
          src_ip: ["127.0.0.1/32", "::1/128", "10.0.0.0/8", "172.16.0.0/12", "192.168.0.0/16"]
          host: ["*.video.example", "*.music.example"]
        action: { type: block }
      - name: allow-private-web
        match:
          src_ip: ["127.0.0.1/32", "::1/128", "10.0.0.0/8", "172.16.0.0/12", "192.168.0.0/16"]
          dst_port: [80, 443]
          host: ["*"]
        action: { type: direct }
